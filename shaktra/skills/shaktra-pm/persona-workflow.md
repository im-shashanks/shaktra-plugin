# Persona Generation Workflow

Create evidence-based user personas from PRD user descriptions and research findings. Personas ground requirements in real user needs and enable traceability.

## Overview

Personas are generated by:
1. Identifying user segments from PRD
2. Enriching with research evidence (if available)
3. Defining JTBD, goals, frustrations
4. Validating evidence thresholds

---

## Steps

### Step 1 — Load Context

Read:
- `.shaktra/settings.yml` — project context
- `.shaktra/prd.md` — primary source for user segments (required)
- `.shaktra/research/synthesis.yml` — research evidence (if exists)
- `.shaktra/research/*.yml` — individual interviews for quotes

### Step 2 — Identify User Segments

Extract user segments from PRD:
- Section 2 (Users & Personas) defines target users
- Each segment becomes a candidate persona

If PRD has no user section:
- Ask user: "Who are the primary users of this product?"
- Capture at least: role, segment, key characteristic

### Step 3 — Generate Personas

For each user segment, spawn **product-manager** (mode: persona-create):

**Required fields:**
```yaml
id: P-001
name: "<Archetype Name — e.g., 'Power User Paula'>"
role: "<job title or user type>"
segment: "<user segment — enterprise, prosumer, casual>"

goals:
  - "<what they want to achieve>"
  - "<second goal>"

frustrations:
  - "<current pain point>"
  - "<second frustration>"

behaviors:
  - "<how they currently work>"
  - "<second behavior>"

jobs_to_be_done:
  - situation: "When I..."
    motivation: "I want to..."
    outcome: "So I can..."

evidence:
  - type: interview | analytics | survey | observation
    id: "<reference ID>"
    insight: "<what this source contributed>"
```

**Evidence sourcing:**
- If research exists: link to specific interviews, quotes, findings
- If no research: use PRD descriptions, mark as `type: assumption`
- Minimum 2 evidence entries required

### Step 4 — Enrich from Research

If `.shaktra/research/synthesis.yml` exists:
1. Match themes to personas by user segment
2. Add specific pain points as frustrations
3. Add JTBD patterns from interviews
4. Include verbatim quotes where powerful
5. Link evidence IDs

### Step 5 — Validate Personas

For each persona, verify:

| Check | Required | Severity |
|---|---|---|
| At least 2 evidence entries | Yes | P0 |
| At least 1 JTBD | Yes | P0 |
| Goals has min 2 entries | Yes | P1 |
| Frustrations has min 2 entries | Yes | P1 |
| Evidence IDs reference existing sources | Yes | P1 |

If validation fails:
- For missing evidence: ask user for additional input or accept with warning
- For missing fields: prompt user to provide

### Step 6 — Write Personas

Write each persona to `.shaktra/personas/{persona_id}.yml`.

Create directory if needed: `.shaktra/personas/`

### Step 7 — Present Summary

```
## Personas Created

**Total:** {count} personas

### Personas
| ID | Name | Segment | Evidence |
|---|---|---|---|
| P-001 | {name} | {segment} | {count} sources |

### Evidence Coverage
- Research-backed: {count} personas with interview evidence
- Assumption-based: {count} personas without research

### Top Jobs-to-be-Done
1. "{JTBD from primary persona}"
2. "{JTBD from secondary persona}"

### Files Created
- .shaktra/personas/P-001.yml
- .shaktra/personas/P-002.yml

### Next Steps
1. Run `/shaktra:pm journey` to create journey maps for each persona
2. Reference personas in PRD requirements: `/shaktra:pm prd`
3. If evidence is thin, gather more research: `/shaktra:pm research`
```

EMIT `PERSONAS_COMPLETE`

---

## Quality Tiers

Based on evidence quality:

| Tier | Evidence | Confidence |
|---|---|---|
| **Validated** | 3+ interview sources | High — use for Must Have requirements |
| **Supported** | 1-2 sources | Medium — use for Should Have requirements |
| **Hypothetical** | Assumptions only | Low — validate before major investment |

Mark each persona's evidence tier in the output summary.

---

## Persona Maintenance

Personas are living documents:
- Update when new research becomes available
- Increment version, add new evidence
- Archive superseded versions
